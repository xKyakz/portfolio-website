<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYAKZ // SYSTEMS ARCHITECT</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'JetBrains Mono', monospace; }
        
        .scanline {
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1));
            background-size: 100% 4px;
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 50; pointer-events: none;
        }

        ::-webkit-scrollbar { width: 8px; background: #18181b; }
        ::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 4px; }

        .btn-disabled { opacity: 0.5; cursor: not-allowed; }
        .code-inactive { opacity: 0.2; filter: grayscale(100%); transition: all 0.3s; }
        .code-active { opacity: 1; border-color: #ef4444; box-shadow: 0 0 20px rgba(239, 68, 68, 0.1); transition: all 0.3s; }
        
        .cmd-input { background: transparent; border: none; outline: none; color: white; width: 100%; font-family: inherit; }
    </style>
</head>
<body class="bg-zinc-950 text-zinc-300 overflow-hidden h-screen flex flex-col selection:bg-red-900 selection:text-white">

    <div class="scanline"></div>

    <header class="h-12 border-b border-zinc-800 flex items-center justify-between px-6 bg-zinc-900/50 z-10 relative">
        <div class="flex items-center space-x-4">
            <span class="text-red-500 font-bold tracking-widest">KYAKZ.OS</span>
            <span class="text-xs text-zinc-500">// KERNEL v4.3.1</span>
        </div>
        <div class="hidden md:flex items-center space-x-6 text-xs text-zinc-500 font-bold">
            <div id="status-mem">MEM: 14MB</div>
            <div id="status-net">NET: CONNECTED</div>
            <div class="text-red-500 animate-pulse">LIVE</div>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden">
        
        <aside class="hidden md:flex w-64 border-r border-zinc-800 flex-col bg-zinc-900/20 overflow-y-auto">
            <div class="p-4 text-xs font-bold text-zinc-500 uppercase tracking-wider">Modules</div>
            
            <nav class="flex-1 space-y-1 px-2" id="nav-container">
                <button onclick="bootModule('terminal')" id="nav-terminal" class="nav-btn w-full text-left px-3 py-2 text-sm rounded border-l-2 transition-all bg-zinc-800 border-red-500 text-white">
                    > ./terminal.lua
                </button>
                <button onclick="bootModule('network')" id="nav-network" class="nav-btn w-full text-left px-3 py-2 text-sm rounded border-l-2 border-transparent text-zinc-400 hover:text-white hover:bg-zinc-800/50 transition-all">
                    > ./replication.lua
                </button>
                <button onclick="bootModule('physics')" id="nav-physics" class="nav-btn w-full text-left px-3 py-2 text-sm rounded border-l-2 border-transparent text-zinc-400 hover:text-white hover:bg-zinc-800/50 transition-all">
                    > ./spatial_hash.lua
                </button>
                <button onclick="bootModule('data')" id="nav-data" class="nav-btn w-full text-left px-3 py-2 text-sm rounded border-l-2 border-transparent text-zinc-400 hover:text-white hover:bg-zinc-800/50 transition-all">
                    > ./atomic_data.lua
                </button>
                <button onclick="bootModule('ai')" id="nav-ai" class="nav-btn w-full text-left px-3 py-2 text-sm rounded border-l-2 border-transparent text-zinc-400 hover:text-white hover:bg-zinc-800/50 transition-all">
                    > ./flow_field.lua
                </button>
            </nav>

            <div class="p-4 border-t border-zinc-800">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-red-600 rounded flex items-center justify-center text-white font-bold">K</div>
                    <div>
                        <div class="text-sm font-bold text-white">User: Kyakz</div>
                        <div class="text-xs text-zinc-500">Perms: ADMIN</div>
                    </div>
                </div>
            </div>
        </aside>

        <section id="viewport" class="flex-1 bg-black/50 p-6 md:p-10 relative overflow-y-auto w-full">
            
            <div id="terminal" class="max-w-3xl mx-auto h-full flex flex-col">
                <div class="mb-8">
                    <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">Lead Systems Architect</h1>
                    <p class="text-lg md:text-xl text-zinc-400">Specialized in Luau Optimization & Engine Scalability.</p>
                </div>

                <div class="bg-zinc-900 border border-zinc-700 rounded-lg p-6 font-mono text-sm shadow-2xl flex-1 flex flex-col" onclick="document.getElementById('cmd-input').focus()">
                    <div class="flex items-center space-x-2 mb-4 border-b border-zinc-700 pb-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <span class="ml-2 text-zinc-500">grimworks_debug_console</span>
                    </div>
                    
                    <div id="console-output" class="space-y-1 text-zinc-300 flex-1 overflow-y-auto custom-scroll mb-2">
                        <div class="text-green-500">[SYSTEM] Booting Kyakz.OS Kernel...</div>
                        <div class="text-zinc-500">[INFO] Loading assets... DONE (0.04s)</div>
                        <div class="text-blue-400">[AUTH] User verified: 6 Years CS Experience</div>
                        <div class="text-zinc-400">Type 'help' for available commands.</div>
                    </div>
                    
                    <div class="flex items-center text-zinc-300">
                        <span class="text-red-500 mr-2">root@kyakz:~$</span>
                        <input type="text" id="cmd-input" class="cmd-input" autocomplete="off" spellcheck="false">
                    </div>
                </div>
            </div>

            <div id="network" class="hidden h-full flex flex-col max-w-6xl mx-auto">
                <div class="mb-6 flex flex-col md:flex-row justify-between items-start md:items-end gap-4">
                    <div>
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-1">Replication <span class="text-red-500">//</span> Lag Compensation</h2>
                        <p class="text-zinc-400 text-sm">Server-side hit registration algorithm for high-latency clients.</p>
                    </div>
                    <div class="flex bg-zinc-900 border border-zinc-700 rounded-lg p-1">
                        <button id="btn-algo-std" onclick="setAlgo('standard')" class="px-4 py-1 text-xs font-bold rounded bg-red-600 text-white transition-all">STANDARD</button>
                        <button id="btn-algo-kyakz" onclick="setAlgo('kyakz')" class="px-4 py-1 text-xs font-bold rounded text-zinc-500 hover:text-white transition-all">KYAKZ REWIND</button>
                    </div>
                </div>

                <div class="relative flex-1 bg-zinc-900/50 border border-zinc-700 rounded-xl overflow-hidden cursor-crosshair min-h-[300px]" id="canvas-container">
                    <canvas id="netCanvas" class="w-full h-full"></canvas>
                    <div class="absolute bottom-4 left-4 right-4 bg-black/80 backdrop-blur p-3 rounded border border-zinc-800 flex items-center space-x-4">
                        <span class="text-xs font-bold text-red-500 whitespace-nowrap">PING:</span>
                        <input type="range" min="0" max="1000" value="0" class="w-full accent-red-500 h-1 bg-zinc-700 rounded-lg appearance-none cursor-pointer" id="pingSlider">
                        <span class="text-xs font-mono text-white w-16 text-right"><span id="pingValue">0</span>ms</span>
                    </div>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div id="code-net-std" class="code-active bg-black/40 border border-zinc-800 p-4 rounded font-mono text-[10px] md:text-xs overflow-hidden text-zinc-500 relative h-40">
                        <div class="absolute top-0 right-0 bg-zinc-800 text-zinc-400 text-[9px] px-2 py-0.5 rounded-bl uppercase tracking-wider">Standard</div>
<pre>
<span class="text-purple-400">function</span> <span class="text-blue-400">VerifyHit</span>(player: <span class="text-yellow-400">Player</span>, target: <span class="text-yellow-400">BasePart</span>)
    <span class="text-zinc-500">-- Fails if ping > 100ms due to desync</span>
    <span class="text-purple-400">local</span> currentPos = target.Position
    <span class="text-purple-400">if</span> (currentPos - player.Character.Aim.Position).Magnitude < 5 <span class="text-purple-400">then</span>
        <span class="text-green-400">return true</span>
    <span class="text-purple-400">end</span>
    <span class="text-purple-400">return false</span>
<span class="text-purple-400">end</span>
</pre>
                    </div>

                    <div id="code-net-kyakz" class="code-inactive bg-black/40 border border-zinc-800 p-4 rounded font-mono text-[10px] md:text-xs overflow-hidden text-zinc-300 relative h-40">
                         <div class="absolute top-0 right-0 bg-red-900/50 text-red-200 text-[9px] px-2 py-0.5 rounded-bl uppercase tracking-wider">Active</div>
<pre>
<span class="text-purple-400">type</span> <span class="text-yellow-400">Snapshot</span> = { t: <span class="text-yellow-400">number</span>, cf: <span class="text-yellow-400">CFrame</span> }
<span class="text-purple-400">local</span> Buffer: { <span class="text-yellow-400">Snapshot</span> } = {} 

<span class="text-purple-400">function</span> <span class="text-blue-400">RewindEngine:Verify</span>(player, target, ping)
    <span class="text-purple-400">local</span> serverTime = <span class="text-yellow-400">workspace</span>:GetServerTimeNow()
    <span class="text-purple-400">local</span> rewindTime = serverTime - (ping/1000)
    
    <span class="text-zinc-500">-- O(log n) Binary Search for historic frame</span>
    <span class="text-purple-400">local</span> oldPos = <span class="text-blue-400">self</span>:GetInterpolatedState(target, rewindTime)
    
    <span class="text-purple-400">return</span> (oldPos - player.Aim).Magnitude < 5
<span class="text-purple-400">end</span>
</pre>
                    </div>
                </div>
            </div>

            <div id="ai" class="hidden h-full flex flex-col max-w-6xl mx-auto">
        </div>

            <div id="physics" class="hidden h-full flex flex-col max-w-6xl mx-auto">
                <div class="mb-6 flex flex-col md:flex-row justify-between items-start md:items-end gap-4">
                    <div>
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-1">Spatial Physics <span class="text-red-500">//</span> Broadphase</h2>
                        <p class="text-zinc-400 text-sm">O(1) collision detection system for high-entity environments.</p>
                    </div>
                    <div class="flex bg-zinc-900 border border-zinc-700 rounded-lg p-1">
                        <button id="btn-phy-std" onclick="setPhyAlgo('standard')" class="px-4 py-1 text-xs font-bold rounded bg-red-600 text-white transition-all">O(N¬≤)</button>
                        <button id="btn-phy-kyakz" onclick="setPhyAlgo('spatial')" class="px-4 py-1 text-xs font-bold rounded text-zinc-500 hover:text-white transition-all">SPATIAL O(1)</button>
                    </div>
                </div>

                <div class="relative flex-1 bg-zinc-900/50 border border-zinc-700 rounded-xl overflow-hidden min-h-[300px]" id="phy-canvas-container">
                    <canvas id="phyCanvas" class="w-full h-full"></canvas>
                    <div class="absolute top-4 left-4 pointer-events-none space-y-1">
                        <div class="text-xs font-mono text-zinc-500">ENTITIES: <span class="text-white">250</span></div>
                        <div class="text-xs font-mono text-zinc-500">CHECKS: <span id="phy-checks" class="text-red-500 font-bold">0</span></div>
                        <div class="text-xs font-mono text-zinc-500">OPT: <span id="phy-opt" class="text-white">0%</span></div>
                    </div>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                     <div id="code-phy-std" class="code-active bg-black/40 border border-zinc-800 p-4 rounded font-mono text-[10px] md:text-xs overflow-hidden text-zinc-500 relative h-40">
                         <div class="absolute top-0 right-0 bg-zinc-800 text-zinc-400 text-[9px] px-2 py-0.5 rounded-bl uppercase tracking-wider">Standard</div>
<pre>
<span class="text-purple-400">task.spawn</span>(<span class="text-purple-400">function</span>()
    <span class="text-purple-400">for</span> i, partA <span class="text-purple-400">in</span> <span class="text-blue-400">pairs</span>(allParts) <span class="text-purple-400">do</span>
        <span class="text-purple-400">for</span> j, partB <span class="text-purple-400">in</span> <span class="text-blue-400">pairs</span>(allParts) <span class="text-purple-400">do</span>
            <span class="text-zinc-500">-- CRITICAL: O(N^2) Complexity</span>
            <span class="text-zinc-500">-- 500 parts = 250,000 checks per frame</span>
            <span class="text-purple-400">if</span> (partA.Position - partB.Position).Magnitude < 5 <span class="text-purple-400">then</span>
                <span class="text-blue-400">collide</span>(partA, partB)
            <span class="text-purple-400">end</span>
        <span class="text-purple-400">end</span>
    <span class="text-purple-400">end</span>
<span class="text-purple-400">end</span>)
</pre>
                    </div>
                    <div id="code-phy-kyakz" class="code-inactive bg-black/40 border border-zinc-800 p-4 rounded font-mono text-[10px] md:text-xs overflow-hidden text-zinc-300 relative h-40">
                         <div class="absolute top-0 right-0 bg-red-900/50 text-red-200 text-[9px] px-2 py-0.5 rounded-bl uppercase tracking-wider">Active</div>
<pre>
<span class="text-purple-400">local</span> GridSize = 20
<span class="text-purple-400">local</span> SpatialMap = {} <span class="text-zinc-500">-- Hash Map</span>

<span class="text-purple-400">function</span> <span class="text-blue-400">Broadphase:Query</span>(part)
    <span class="text-purple-400">local</span> key = <span class="text-blue-400">math.floor</span>(part.X/GridSize)..<span class="text-green-400">":"</span>..<span class="text-blue-400">math.floor</span>(part.Z/GridSize)
    <span class="text-purple-400">local</span> neighbors = SpatialMap[key] <span class="text-purple-400">or</span> {}
    
    <span class="text-purple-400">for</span> _, neighbor <span class="text-purple-400">in</span> <span class="text-blue-400">pairs</span>(neighbors) <span class="text-purple-400">do</span>
         <span class="text-zinc-500">-- Only checks ~5 nearby parts. O(1)</span>
         <span class="text-blue-400">Narrowphase:Solve</span>(part, neighbor)
    <span class="text-purple-400">end</span>
<span class="text-purple-400">end</span>
</pre>
                    </div>
                </div>
            </div>

            <div id="data" class="hidden h-full flex flex-col max-w-6xl mx-auto">
                <div class="mb-6 flex flex-col md:flex-row justify-between items-start md:items-end gap-4">
                    <div>
                        <h2 class="text-2xl md:text-3xl font-bold text-white mb-1">Atomic Data <span class="text-red-500">//</span> Session Locking</h2>
                        <p class="text-zinc-400 text-sm">ACID-compliant transaction system.</p>
                    </div>
                    <div class="flex bg-zinc-900 border border-zinc-700 rounded-lg p-1">
                        <button id="btn-data-std" onclick="setDataAlgo('standard')" class="px-4 py-1 text-xs font-bold rounded bg-red-600 text-white transition-all">UNSAFE</button>
                        <button id="btn-data-kyakz" onclick="setDataAlgo('atomic')" class="px-4 py-1 text-xs font-bold rounded text-zinc-500 hover:text-white transition-all">ATOMIC</button>
                    </div>
                </div>

                <div class="relative flex-1 bg-zinc-900/50 border border-zinc-700 rounded-xl overflow-hidden flex flex-col items-center justify-center min-h-[400px]">
                    
                    <div class="flex items-center justify-between w-full max-w-2xl px-4 md:px-10 relative z-10">
                        <div class="text-center">
                            <div class="w-16 h-16 md:w-24 md:h-24 bg-zinc-800 rounded-2xl border-2 border-zinc-600 flex items-center justify-center text-2xl md:text-3xl mb-2 relative transition-all duration-300" id="wallet-a-bg">
                                üí∞
                                <div class="absolute -top-2 -right-2 bg-blue-500 text-[10px] md:text-xs font-bold px-2 py-0.5 rounded text-white">SENDER</div>
                            </div>
                            <div class="font-mono text-lg md:text-xl font-bold text-white">$<span id="wallet-a-val">1000</span></div>
                        </div>

                        <div class="flex-1 h-1 bg-zinc-700 mx-4 md:mx-8 relative">
                            <div id="data-packet" class="w-6 h-6 md:w-8 md:h-8 bg-yellow-500 rounded-full absolute -top-2.5 md:-top-3.5 left-0 shadow-[0_0_15px_rgba(234,179,8,0.5)] flex items-center justify-center text-[10px] md:text-xs font-bold text-black opacity-0">
                                $
                            </div>
                        </div>

                        <div class="text-center">
                            <div class="w-16 h-16 md:w-24 md:h-24 bg-zinc-800 rounded-2xl border-2 border-zinc-600 flex items-center justify-center text-2xl md:text-3xl mb-2" id="wallet-b-bg">
                                üè¶
                                <div class="absolute -top-2 -right-2 bg-green-500 text-[10px] md:text-xs font-bold px-2 py-0.5 rounded text-white">RECEIVER</div>
                            </div>
                            <div class="font-mono text-lg md:text-xl font-bold text-white">$<span id="wallet-b-val">0</span></div>
                        </div>
                    </div>

                    <div class="mt-12 flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4">
                        <button onclick="startTransaction()" class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-6 rounded shadow-lg transition-all text-xs md:text-sm">
                            INITIATE TRANSFER
                        </button>
                        <button onclick="simulateCrash()" id="btn-crash" class="btn-disabled bg-red-900/50 text-red-200 border border-red-800 font-bold py-2 px-6 rounded shadow-lg transition-all text-xs md:text-sm">
                            ‚ö† SIMULATE CRASH
                        </button>
                    </div>

                    <div id="data-status" class="mt-8 font-mono text-xs md:text-sm text-zinc-500 h-6">Waiting...</div>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                     <div id="code-data-std" class="code-active bg-black/40 border border-zinc-800 p-4 rounded font-mono text-[10px] md:text-xs overflow-hidden text-zinc-500 relative h-40">
                         <div class="absolute top-0 right-0 bg-zinc-800 text-zinc-400 text-[9px] px-2 py-0.5 rounded-bl uppercase tracking-wider">Standard</div>
<pre>
<span class="text-purple-400">function</span> <span class="text-blue-400">TradeSystem:Process</span>(p1, p2, amount)
    <span class="text-zinc-500">-- DANGEROUS: If server crashes here, funds vanish.</span>
    p1.Leaderstats.Cash.Value -= amount
    
    <span class="text-blue-400">task.wait</span>(2) <span class="text-zinc-500">-- Http/DB Latency</span>
    
    p2.Leaderstats.Cash.Value += amount
<span class="text-purple-400">end</span>
</pre>
                    </div>
                     <div id="code-data-kyakz" class="code-inactive bg-black/40 border border-zinc-800 p-4 rounded font-mono text-[10px] md:text-xs overflow-hidden text-zinc-300 relative h-40">
                         <div class="absolute top-0 right-0 bg-red-900/50 text-red-200 text-[9px] px-2 py-0.5 rounded-bl uppercase tracking-wider">Active</div>
<pre>
<span class="text-purple-400">function</span> <span class="text-blue-400">Atomic:Transaction</span>(key, callback)
    <span class="text-yellow-400">DataStore</span>:UpdateAsync(key, <span class="text-purple-400">function</span>(oldData)
        <span class="text-zinc-500">-- Session Lock Check</span>
        <span class="text-purple-400">if</span> oldData.JobId ~= <span class="text-blue-400">game</span>.JobId <span class="text-purple-400">then</span> <span class="text-purple-400">return nil</span> <span class="text-purple-400">end</span>
        
        <span class="text-zinc-500">-- ACID Compliance: All or Nothing</span>
        <span class="text-purple-400">local</span> newData = <span class="text-blue-400">deepcopy</span>(oldData)
        <span class="text-purple-400">local</span> success = <span class="text-blue-400">pcall</span>(callback, newData)
        
        <span class="text-purple-400">return</span> success <span class="text-purple-400">and</span> newData <span class="text-purple-400">or</span> <span class="text-purple-400">nil</span>
    <span class="text-purple-400">end</span>)
<span class="text-purple-400">end</span>
</pre>
                    </div>
                </div>
            </div>

        </section>
    </main>

    <script src="js/core.js"></script>
    <script src="js/terminal.js"></script>
    <script src="js/network.js"></script>
    <script src="js/physics.js"></script>
    <script src="js/data.js"></script>
</body>
</html>